<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AbueClick</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style/style.css">
  <style>
    html {
      scroll-behavior: smooth;
    }
  </style>
</head>

<body>
  <!-- Estructura convencional y escalable sin partials -->
  <div class="sitio">
    <header id="barra-navegacion">
      <div class="nav-izquierda">
        <div class="marca">
          <img src="resources/img/Imagotipo.png" alt="AbueClick" class="logo-navegacion">
        </div>
        <button class="boton-menu-movil" id="botonMenuMovil">‚ò∞</button>
        <nav>
            <ul class="menu-navegacion">
              <li><a href="index.html">Inicio</a></li>
              <li><a href="sobre-nosotros.html">Sobre nosotros</a></li>
              <li id="navMisCitas" style="display: none;"><a href="mis-citas.html">Mis Citas</a></li>
              <li><a href="#pie-pagina">Contacto</a></li>
            </ul>
        </nav>
      </div>
      <div class="menu-movil" id="menuMovil">
        <ul>
          <li><a href="index.html">Inicio</a></li>
          <li><a href="sobre-nosotros.html">Sobre nosotros</a></li>
          <li id="navMisCitasMobile" style="display: none;"><a href="mis-citas.html">Mis Citas</a></li>
          <li><a href="#pie-pagina">Contacto</a></li>
        </ul>
      </div>

      <div class="nav-derecha">
        <form class="formulario-busqueda" role="search" onsubmit="return false;">
          <input class="entrada-busqueda" type="search" placeholder="Buscar..." aria-label="Buscar">
        </form>
        <a href="notificaciones.html" class="boton-notificaciones" aria-label="Notificaciones" title="Notificaciones" id="enlaceNotificaciones">
          <span class="icono-notificacion">üîî</span>
          <span class="insignia-notificacion" id="insigniaNotificacion" style="display: none;">0</span>
        </a>
        <a href="chat.html" class="boton-chat" aria-label="Chat" title="Chat">
          <span class="icono-chat">üí¨</span>
        </a>
        <a href="perfil.html" class="boton-perfil" aria-label="Perfil" title="Perfil">
          <span class="circulo-avatar" id="avatarUsuario">AC</span>
        </a>
      </div>
    </header>

    <div class="contenido">
      <aside id="barra-lateral">
        <h2>Seleccione el servicio que deseas:</h2>
        <ul class="lista-barra-lateral">
            <li>
              <a href="servicio-cita-medica.html">
                <img src="resources/icons/atencion-medica.png" alt="" class="icono-barra-lateral">
                <span class="etiqueta-barra-lateral">Cita Medica</span>
              </a>
            </li>
            <li>
              <a href="servicio-eventos.html">
                <img src="resources/icons/calendario.png" alt="Calendario" class="icono-barra-lateral">
                <span class="etiqueta-barra-lateral">Eventos</span>
              </a>
            </li>
            <li>
              <a href="servicio-compras.html">
                <img src="resources/icons/carrito-de-compras.png" alt="carrito-de-compras" class="icono-barra-lateral">
                <span class="etiqueta-barra-lateral">Compras</span>
              </a>
            </li>
            <li>
              <a href="servicio-tramites.html">
                <img src="resources/icons/contrato.png" alt="Tramites" class="icono-barra-lateral">
                <span class="etiqueta-barra-lateral">Tramites</span>
              </a>
            </li>
        </ul>
      </aside>

      <main id="contenido-principal">
        <section class="seccion-principal">
          <h1>Bienvenido a AbueClick</h1>
          <p>Conoce algunos de nuestros acompa√±antes disponibles</p>

          <div id="contenedorAcompanantes" class="cuadricula-acompanantes">
            <!-- Los acompa√±antes se cargar√°n din√°micamente aqu√≠ -->
          </div>
        </section>
      </main>
    </div>

    <footer id="pie-pagina">
      <div class="contenedor-pie-pagina">
        <div class="columna-pie-pagina">
          <h3 class="titulo-pie-pagina">ABUECLICK</h3>
          <h4 class="subtitulo-pie-pagina">CONT√ÅCTANOS</h4>
          <div class="item-contacto-pie-pagina">
            <span class="icono-pie-pagina">üìû</span>
            <div>
              <p class="etiqueta-pie-pagina">L√≠nea de servicio</p>
              <p class="valor-pie-pagina">+57 314 6904576</p>
            </div>
          </div>
          <div class="item-contacto-pie-pagina">
            <span class="icono-pie-pagina">üìß</span>
            <div>
              <p class="etiqueta-pie-pagina">Correo electr√≥nico</p>
              <p class="valor-pie-pagina">AbueClick@gmail.com</p>
            </div>
          </div>
          <div class="item-contacto-pie-pagina">
            <span class="icono-pie-pagina">üí¨</span>
            <div>
              <p class="etiqueta-pie-pagina">WhatsApp</p>
              <p class="valor-pie-pagina">+57 314 6904576</p>
            </div>
          </div>
        </div>

        <div class="columna-pie-pagina">
          <h3 class="titulo-pie-pagina">INFORMACI√ìN</h3>
          <h4 class="subtitulo-pie-pagina">POL√çTICAS</h4>
          <ul class="enlaces-pie-pagina">
            <li><a href="#">Pol√≠tica de privacidad</a></li>
            <li><a href="#">T√©rminos y condiciones</a></li>
            <li><a href="#">Pol√≠tica de cookies</a></li>
          </ul>
          <h4 class="subtitulo-pie-pagina" style="margin-top: 20px;">ENLACES</h4>
          <ul class="enlaces-pie-pagina">
            <li><a href="index.html">Inicio</a></li>
            <li><a href="sobre-nosotros.html">Sobre nosotros</a></li>
            <li><a href="login.html">Iniciar sesi√≥n</a></li>
            <li><a href="registro.html">Registrarse</a></li>
          </ul>
        </div>

        <div class="columna-pie-pagina">
          <h3 class="titulo-pie-pagina">REDES SOCIALES</h3>
          <div class="redes-pie-pagina">
            <a href="#" class="enlace-red-social">Facebook</a>
            <a href="#" class="enlace-red-social">Instagram</a>
            <a href="#" class="enlace-red-social">Twitter</a>
            <a href="#" class="enlace-red-social">LinkedIn</a>
          </div>
          <div class="actualizacion-pie-pagina">
            <p class="etiqueta-pie-pagina">Fecha √∫ltima actualizaci√≥n</p>
            <p class="valor-pie-pagina">2025</p>
          </div>
        </div>
      </div>
      <div class="fondo-pie-pagina">
        <p>¬© 2025 AbueClick. Todos los derechos reservados.</p>
      </div>
    </footer>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/firebase-database.js"></script>
  <script src="js/database.js"></script>
  <script src="js/autenticacion.js"></script>
  <script src="js/servicio.js"></script>
  <script src="js/notificaciones.js"></script>
  <script>
    // Funci√≥n para obtener acompa√±antes aleatorios
    function obtenerAcompanantesAleatorios(cantidad = 5) {
      const acompanantes = obtenerAcompanantesRegistrados();
      
      // Mezclar array aleatoriamente
      const acompanantesMezclados = acompanantes.sort(() => Math.random() - 0.5);
      
      // Tomar hasta la cantidad solicitada
      return acompanantesMezclados.slice(0, cantidad);
    }

    // Funci√≥n para calcular edad aproximada desde fecha de nacimiento
    function calcularEdad(fechaNacimiento) {
      if (!fechaNacimiento) return 'No especificada';
      const hoy = new Date();
      const nacimiento = new Date(fechaNacimiento);
      let edad = hoy.getFullYear() - nacimiento.getFullYear();
      const mes = hoy.getMonth() - nacimiento.getMonth();
      if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) {
        edad--;
      }
      return edad;
    }

    function mostrarAcompanantesEnInicio() {
      const contenedor = document.getElementById('contenedorAcompanantes');
      if (!contenedor) return;

      const acompanantes = obtenerAcompanantesAleatorios(5);
      
      if (acompanantes.length === 0) {
        contenedor.innerHTML = `
          <div class="sin-acompanantes">
            <p>Por el momento no hay acompa√±antes disponibles. Vuelve pronto para conocer nuestros profesionales.</p>
          </div>
        `;
        return;
      }

      contenedor.innerHTML = '';
      
      acompanantes.forEach(acompanante => {
        const tarjeta = document.createElement('div');
        tarjeta.className = 'tarjeta-perfil';
        
        const usuarios = obtenerUsuarios();
        const usuario = usuarios.find(u => u.email === acompanante.email);
        
        const edad = usuario && usuario.fechaNacimiento 
          ? calcularEdad(usuario.fechaNacimiento) 
          : 'No especificada';
        
        // Obtener avatar del usuario si existe, sino usar imagen por defecto
        let avatarSrc = 'resources/perfiles/mujer.png';
        if (usuario && usuario.avatar) {
          // Si el avatar es una URL base64 o una ruta v√°lida
          avatarSrc = usuario.avatar;
        }
        
        tarjeta.innerHTML = `
          ${usuario && usuario.avatar 
            ? `<img src="${avatarSrc}" alt="${acompanante.nombre}" class="foto-perfil" onerror="this.src='resources/perfiles/mujer.png'; this.onerror=null;">`
            : `<img src="${avatarSrc}" alt="${acompanante.nombre}" class="foto-perfil">`
          }
          <div class="info-perfil">
            <h2 class="nombre-perfil">${acompanante.nombre}</h2>
            <div class="meta-perfil">
              <span>Edad: ${edad}</span> ¬∑ 
              <span>Experiencia: ${acompanante.experiencia || 'Sin especificar'}</span>
            </div>
            <p class="descripcion-perfil">${acompanante.descripcion || 'Acompa√±ante profesional disponible para ayudarle.'}</p>
            <p class="especificacion-perfil"><strong>Especialidad:</strong> ${acompanante.especialidad}</p>
            ${acompanante.ciudad ? `<p class="especificacion-perfil"><strong>Ciudad:</strong> ${acompanante.ciudad.charAt(0).toUpperCase() + acompanante.ciudad.slice(1)}</p>` : ''}
            ${acompanante.telefono ? `<p class="especificacion-perfil"><strong>Tel√©fono:</strong> ${acompanante.telefono}</p>` : ''}
            <button class="boton-contacto" onclick="seleccionarServicio('${acompanante.id || acompanante.email}')">Ver Perfil</button>
          </div>
        `;
        
        contenedor.appendChild(tarjeta);
      });
    }

    // Funci√≥n para mostrar modal de selecci√≥n de servicio
    function seleccionarServicio(acompananteId) {
      const modal = document.createElement('div');
      modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 10000;';
      
      const modalContent = document.createElement('div');
      modalContent.style.cssText = 'background: white; padding: 40px; border-radius: 12px; max-width: 500px; width: 90%; box-shadow: 0 4px 20px rgba(0,0,0,0.3);';
      
      modalContent.innerHTML = `
        <h2 style="margin-top: 0; color: #52a6c4; font-size: 28px; margin-bottom: 20px; text-align: center;">Selecciona el servicio</h2>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">Elige el tipo de servicio que necesitas:</p>
        <div style="display: flex; flex-direction: column; gap: 15px;">
          <button onclick="window.location.href='servicio-cita-medica.html'" style="display: flex; align-items: center; gap: 15px; padding: 20px; background: linear-gradient(135deg, #fff980 0%, #ffffff 100%); border: 2px solid #faba4d; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 18px; font-weight: 600; color: #333; width: 100%;">
            <img src="resources/icons/atencion-medica.png" alt="Cita M√©dica" style="width: 40px; height: 40px;">
            <span>Cita M√©dica</span>
          </button>
          <button onclick="window.location.href='servicio-eventos.html'" style="display: flex; align-items: center; gap: 15px; padding: 20px; background: linear-gradient(135deg, #fff980 0%, #ffffff 100%); border: 2px solid #faba4d; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 18px; font-weight: 600; color: #333; width: 100%;">
            <img src="resources/icons/calendario.png" alt="Eventos" style="width: 40px; height: 40px;">
            <span>Eventos</span>
          </button>
          <button onclick="window.location.href='servicio-compras.html'" style="display: flex; align-items: center; gap: 15px; padding: 20px; background: linear-gradient(135deg, #fff980 0%, #ffffff 100%); border: 2px solid #faba4d; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 18px; font-weight: 600; color: #333; width: 100%;">
            <img src="resources/icons/carrito-de-compras.png" alt="Compras" style="width: 40px; height: 40px;">
            <span>Compras</span>
          </button>
          <button onclick="window.location.href='servicio-tramites.html'" style="display: flex; align-items: center; gap: 15px; padding: 20px; background: linear-gradient(135deg, #fff980 0%, #ffffff 100%); border: 2px solid #faba4d; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 18px; font-weight: 600; color: #333; width: 100%;">
            <img src="resources/icons/contrato.png" alt="Tr√°mites" style="width: 40px; height: 40px;">
            <span>Tr√°mites</span>
          </button>
        </div>
        <button onclick="this.closest('div[style*=\\"position: fixed\\"]').remove()" style="margin-top: 25px; width: 100%; padding: 12px; background: #e0e0e0; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; color: #666; transition: all 0.3s;">
          Cancelar
        </button>
      `;
      
      // Agregar efectos hover a los botones
      const botones = modalContent.querySelectorAll('button[onclick*="servicio"]');
      botones.forEach(btn => {
        btn.onmouseenter = function() {
          this.style.transform = 'translateY(-2px)';
          this.style.boxShadow = '0 4px 12px rgba(82, 166, 196, 0.3)';
          this.style.borderColor = '#52a6c4';
        };
        btn.onmouseleave = function() {
          this.style.transform = 'translateY(0)';
          this.style.boxShadow = 'none';
          this.style.borderColor = '#faba4d';
        };
      });
      
      modal.appendChild(modalContent);
      document.body.appendChild(modal);
      
      // Cerrar al hacer clic fuera del modal
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Verificar sesi√≥n al cargar la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
      const usuarioActual = verificarSesion();
      
      // Cargar acompa√±antes
      mostrarAcompanantesEnInicio();
      
      // Si hay sesi√≥n, actualizar avatar y badge de notificaciones
      if (usuarioActual) {
        actualizarAvatarGlobal();
        actualizarBadgeNotificaciones();
        const navMisCitas = document.getElementById('navMisCitas');
        const navMisCitasMobile = document.getElementById('navMisCitasMobile');
        if (navMisCitas) navMisCitas.style.display = 'list-item';
        if (navMisCitasMobile) navMisCitasMobile.style.display = 'list-item';
      } else {
        const navDerecha = document.querySelector('.nav-derecha');
        if (navDerecha) {
          const enlaceNotificaciones = document.getElementById('enlaceNotificaciones');
          const botonChat = document.querySelector('.boton-chat');
          const botonPerfil = document.querySelector('.boton-perfil');
          
          if (enlaceNotificaciones) enlaceNotificaciones.style.display = 'none';
          if (botonChat) botonChat.style.display = 'none';
          if (botonPerfil) {
            botonPerfil.href = 'login.html';
            botonPerfil.innerHTML = '<span class="circulo-avatar" style="padding: 8px 16px; font-size: 14px;">Iniciar Sesi√≥n</span>';
            botonPerfil.title = 'Iniciar Sesi√≥n';
          }
          
          const botonLoginExistente = document.querySelector('.boton-login-nav');
          if (!botonLoginExistente) {
            const botonLogin = document.createElement('a');
            botonLogin.href = 'login.html';
            botonLogin.className = 'boton-login-nav';
            botonLogin.textContent = 'Iniciar Sesi√≥n';
            botonLogin.style.cssText = 'padding: 10px 20px; background: #667eea; color: white; border-radius: 6px; text-decoration: none; font-family: Poppins, sans-serif; margin-left: 10px; font-weight: 500; transition: all 0.3s;';
            botonLogin.onmouseover = function() { this.style.background = '#5568d3'; };
            botonLogin.onmouseout = function() { this.style.background = '#667eea'; };
            navDerecha.insertBefore(botonLogin, navDerecha.firstChild);
          }
        }
      }

      const botonMenuMovil = document.getElementById('botonMenuMovil');
      const menuMovil = document.getElementById('menuMovil');
      if (botonMenuMovil && menuMovil) {
        botonMenuMovil.addEventListener('click', function() {
          menuMovil.classList.toggle('activo');
          if (menuMovil.classList.contains('activo')) {
            botonMenuMovil.textContent = '‚úï';
          } else {
            botonMenuMovil.textContent = '‚ò∞';
          }
        });

        document.querySelectorAll('.menu-movil a').forEach(enlace => {
          enlace.addEventListener('click', function() {
            menuMovil.classList.remove('activo');
            botonMenuMovil.textContent = '‚ò∞';
          });
        });
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="java.js"></script>
  <script src="js/autenticacion.js"></script>
  <script src="js/boton-admin.js"></script>
  <script src="js/texto-a-voz.js"></script>
</body>

</html>